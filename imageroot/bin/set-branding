#!/usr/bin/env python3
#
# Copyright (C) 2025 Nethesis S.r.l.
# SPDX-License-Identifier: GPL-3.0-or-later
#

import os
import sys
import subprocess

# Container name
container_name = "lemonldapng-app"

# Branding settings to apply
branding_settings = {
    "portalMainLogo": "CustomTheme/nethserver.png",
    "portalCustomCss": "CustomTheme/custom.css",
    "portalFavicon": "CustomTheme/favicon.ico"
}

# Build the CLI command
command = [
    "podman", "exec", container_name,
    "/usr/share/lemonldap-ng/bin/lemonldap-ng-cli", "-yes", "1", "set"
]

# Flatten the dictionary into CLI arguments
for key, value in branding_settings.items():
    command.extend([key, value])

# Run the command
try:
    subprocess.run(command, stderr=subprocess.DEVNULL, check=True)
    print("Branding settings applied successfully.")
except subprocess.CalledProcessError as e:
    print("Failed to apply branding settings.", file=sys.stderr)
    sys.exit(1)
